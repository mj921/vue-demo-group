(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-efa6cf8c"],{1276:function(e,t,r){"use strict";var i=r("d784"),a=r("44e7"),n=r("825a"),s=r("1d80"),o=r("4840"),c=r("8aa5"),u=r("50c4"),l=r("14c3"),f=r("9263"),p=r("d039"),d=[].push,h=Math.min,v=4294967295,m=!p((function(){return!RegExp(v,"y")}));i("split",2,(function(e,t,r){var i;return i="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,r){var i=String(s(this)),n=void 0===r?v:r>>>0;if(0===n)return[];if(void 0===e)return[i];if(!a(e))return t.call(i,e,n);var o,c,u,l=[],p=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),h=0,m=new RegExp(e.source,p+"g");while(o=f.call(m,i)){if(c=m.lastIndex,c>h&&(l.push(i.slice(h,o.index)),o.length>1&&o.index<i.length&&d.apply(l,o.slice(1)),u=o[0].length,h=c,l.length>=n))break;m.lastIndex===o.index&&m.lastIndex++}return h===i.length?!u&&m.test("")||l.push(""):l.push(i.slice(h)),l.length>n?l.slice(0,n):l}:"0".split(void 0,0).length?function(e,r){return void 0===e&&0===r?[]:t.call(this,e,r)}:t,[function(t,r){var a=s(this),n=void 0==t?void 0:t[e];return void 0!==n?n.call(t,a,r):i.call(String(a),t,r)},function(e,a){var s=r(i,e,this,a,i!==t);if(s.done)return s.value;var f=n(e),p=String(this),d=o(f,RegExp),g=f.unicode,y=(f.ignoreCase?"i":"")+(f.multiline?"m":"")+(f.unicode?"u":"")+(m?"y":"g"),E=new d(m?f:"^(?:"+f.source+")",y),T=void 0===a?v:a>>>0;if(0===T)return[];if(0===p.length)return null===l(E,p)?[p]:[];var b=0,k=0,R=[];while(k<p.length){E.lastIndex=m?k:0;var O,_=l(E,m?p:p.slice(k));if(null===_||(O=h(u(E.lastIndex+(m?0:k)),p.length))===b)k=c(p,k,g);else{if(R.push(p.slice(b,k)),R.length===T)return R;for(var P=1;P<=_.length-1;P++)if(R.push(_[P]),R.length===T)return R;k=b=O}}return R.push(p.slice(b)),R}]}),!m)},"159b":function(e,t,r){var i=r("da84"),a=r("fdbc"),n=r("17c2"),s=r("9112");for(var o in a){var c=i[o],u=c&&c.prototype;if(u&&u.forEach!==n)try{s(u,"forEach",n)}catch(l){u.forEach=n}}},"17c2":function(e,t,r){"use strict";var i=r("b727").forEach,a=r("a640"),n=a("forEach");e.exports=n?[].forEach:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}},"1bed":function(e,t,r){},"1cc4":function(e,t,r){"use strict";r("308b")},"1dd1":function(e,t,r){"use strict";r("e997")},2532:function(e,t,r){"use strict";var i=r("23e7"),a=r("5a34"),n=r("1d80"),s=r("ab13");i({target:"String",proto:!0,forced:!s("includes")},{includes:function(e){return!!~String(n(this)).indexOf(a(e),arguments.length>1?arguments[1]:void 0)}})},"25f0":function(e,t,r){"use strict";var i=r("6eeb"),a=r("825a"),n=r("d039"),s=r("ad6d"),o="toString",c=RegExp.prototype,u=c[o],l=n((function(){return"/a/b"!=u.call({source:"a",flags:"b"})})),f=u.name!=o;(l||f)&&i(RegExp.prototype,o,(function(){var e=a(this),t=String(e.source),r=e.flags,i=String(void 0===r&&e instanceof RegExp&&!("flags"in c)?s.call(e):r);return"/"+t+"/"+i}),{unsafe:!0})},"308b":function(e,t,r){},4403:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",["menu"===e.scene?r("game-menu",{on:{start:e.start}}):e._e(),"game"===e.scene?r("game-main",{on:{backMenu:e.backMenu}}):e._e(),r("button",{on:{click:e.add}},[e._v("add")])],1)},a=[],n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"game-main"},[r("div",{staticClass:"cave-info"},[r("span",[e._v(e._s(e.cave))]),r("el-switch",{attrs:{disabled:"selectOption"!==e.status},on:{change:e.showSkillOptions},model:{value:e.testFlag,callback:function(t){e.testFlag=t},expression:"testFlag"}},[e._v("测试 ")]),r("span",[e._v(e._s((e.time/1e3).toFixed(2)))])],1),r("div",{staticClass:"info"},[r("dl",[r("label",{attrs:{for:""}},[e._v("攻击")]),r("span",[e._v(e._s("battle"===e.status?e.enemy.currProps.atk:e.enemy.atk))])]),r("dl",[r("label",{attrs:{for:""}},[e._v("暴击")]),r("span",[e._v(e._s("battle"===e.status?e.enemy.currProps.cir:e.enemy.cir))])]),r("dl",[r("label",{attrs:{for:""}},[e._v("闪避")]),r("span",[e._v(" "+e._s("battle"===e.status?e.enemy.currProps.dodge:e.enemy.dodge)+" ")])]),r("num-disappear",{ref:"enemyNumDisappear"})],1),r("hp-bar",{attrs:{curr:e.enemy&&e.enemy.currProps&&e.enemy.currProps.hp||0,max:e.enemy&&e.enemy.currProps&&e.enemy.currProps.maxHp||0}}),r("skill-options",{attrs:{skills:e.skillOptions},on:{select:e.selectSkill},model:{value:e.skillOptionVisible,callback:function(t){e.skillOptionVisible=t},expression:"skillOptionVisible"}}),r("el-button",{directives:[{name:"show",rawName:"v-show",value:"waitBattle"===e.status,expression:"status === 'waitBattle'"}],attrs:{type:"primary",size:"default"},on:{click:e.createBattlefield}},[e._v(" 战斗 ")]),r("div",{staticClass:"info"},[r("dl",[r("label",{attrs:{for:""}},[e._v("攻击")]),r("span",[e._v(" "+e._s("battle"===e.status?e.player.currProps.atk:e.player.atk)+" ")])]),r("dl",[r("label",{attrs:{for:""}},[e._v("暴击")]),r("span",[e._v(" "+e._s("battle"===e.status?e.player.currProps.cir:e.player.cir)+" ")])]),r("dl",[r("label",{attrs:{for:""}},[e._v("闪避")]),r("span",[e._v(" "+e._s("battle"===e.status?e.player.currProps.dodge:e.player.dodge)+" ")])]),r("num-disappear",{ref:"playerNumDisappear"})],1),r("hp-bar",{attrs:{curr:e.player&&e.player.currProps&&e.player.currProps.hp||e.player.hp||0,max:e.player&&e.player.currProps&&e.player.currProps.maxHp||e.player.hp||0}}),r("el-button",{attrs:{type:"primary",size:"default"},on:{click:e.backMenu}},[e._v(" 菜单 ")])],1)},s=[],o=r("5530"),c=r("d4ec"),u=r("bee2"),l=(r("b0c0"),r("6062"),r("d3b7"),r("3ca3"),r("ddb0"),r("159b"),r("1276"),r("ac1f"),r("a434"),r("4de4"),r("caad"),r("2532"),r("99af"),{GET_TRIGGER:1,BATTLE_TRIGGER:2,BATTLE_WIN_TRIGGER:3}),f={OBTAIN:1,TIME_ONCE:2,TIME_INTERVAL:3,UNDER_ATTACK:4,UNDER_DAMAGE:5},p={PROP:1,DAMAGE:2,PROBABILITY_DAMAGE:3,RESTORE_HP:4,PROBABILITY_RESTORE_HP:5,CONDITION_RESTORE_HP:6,REDUCTION_DAMAGE:7,PROBABILITY_REDUCTION_DAMAGE:8},d={FIXED_VALUE:1,PERCENTAGE:2,FORMULA:3},h={SELF:1,ENEMY:2},v=[{id:1,name:"",skillType:l.GET_TRIGGER,effects:[{triggerType:f.OBTAIN,effectType:p.PROP,targetType:h.SELF,valueType:d.FIXED_VALUE,propKey:"atk",propNum:3,propType:h.SELF}],maxLv:0,desc:function(){var e=this.lv,t=void 0===e?1:e;return"增加".concat(t*this.effects[0].propNum,"攻击力")}},{id:2,name:"",skillType:l.BATTLE_TRIGGER,effects:[{triggerType:f.TIME_ONCE,effectType:p.PROP,targetType:h.SELF,valueType:d.FIXED_VALUE,propKey:"atk",propNum:6,triggerTime:0},{triggerType:f.TIME_ONCE,effectType:p.PROP,targetType:h.SELF,valueType:d.FIXED_VALUE,propKey:"atk",propNum:-6,triggerTime:2e3}],maxLv:0,desc:function(){var e=this.lv,t=void 0===e?1:e;return"战斗开始2秒内增加".concat(t*this.effects[0].propNum,"攻击力")}},{id:3,name:"",skillType:l.BATTLE_TRIGGER,effects:[{triggerType:f.TIME_INTERVAL,effectType:p.PROP,targetType:h.SELF,valueType:d.FIXED_VALUE,propKey:"atk",propNum:1,intervalTime:1e3}],maxLv:0,desc:function(){var e=this.lv,t=void 0===e?1:e;return"每秒增加".concat(t*this.effects[0].propNum,"攻击力")}},{id:4,name:"",skillType:l.BATTLE_TRIGGER,effects:[{triggerType:f.UNDER_ATTACK,effectType:p.PROBABILITY_DAMAGE,targetType:h.ENEMY,valueType:d.FIXED_VALUE,damage:7,probability:30}],maxLv:0,desc:function(){var e=this.lv,t=void 0===e?1:e,r=this.effects[0],i=r.probability,a=r.damage;return"受到攻击时".concat(i,"%概率造成").concat(t*a,"点伤害")}},{id:5,name:"",skillType:l.BATTLE_TRIGGER,effects:[{triggerType:f.UNDER_ATTACK,effectType:p.PROBABILITY_REDUCTION_DAMAGE,targetType:h.SELF,valueType:d.FIXED_VALUE,reductionDamage:3,probability:30}],maxLv:0,desc:function(){var e=this.lv,t=void 0===e?1:e,r=this.effects[0],i=r.probability,a=r.reductionDamage;return"受到攻击时".concat(i,"%概率减免").concat(t*a,"点伤害")}},{id:6,name:"",skillType:l.BATTLE_TRIGGER,effects:[{triggerType:f.TIME_INTERVAL,effectType:p.RESTORE_HP,targetType:h.SELF,valueType:d.FIXED_VALUE,restoreHp:30,intervalTime:1e3}],maxLv:0,desc:function(){var e=this.lv,t=void 0===e?1:e,r=this.effects[0].restoreHp;return"每秒回复".concat(t*r,"点生命值")}},{id:7,name:"",skillType:l.BATTLE_TRIGGER,effects:[{triggerType:f.TIME_INTERVAL,effectType:p.CONDITION_RESTORE_HP,targetType:h.SELF,valueType:d.FIXED_VALUE,restoreHp:42,intervalTime:1e3,condition:"(hp/maxHp)>0.5"}],maxLv:0,desc:function(){var e=this.lv,t=void 0===e?1:e,r=this.effects[0].restoreHp;return"当生命值大于50%时，每秒回复".concat(t*r,"点生命值")}},{id:8,name:"",skillType:l.BATTLE_TRIGGER,effects:[{triggerType:f.TIME_INTERVAL,effectType:p.RESTORE_HP,targetType:h.SELF,valueType:d.PERCENTAGE,percentageProp:"maxHp",restoreHp:1,intervalTime:1e3}],maxLv:0,desc:function(){var e=this.lv,t=void 0===e?1:e,r=this.effects[0].restoreHp;return"每秒回复".concat(r*t,"%最大生命值")}},{id:9,name:"",skillType:l.BATTLE_TRIGGER,effects:[{triggerType:f.OBTAIN,effectType:p.PROP,targetType:h.SELF,valueType:d.PERCENTAGE,propKey:"hp",percentageProp:"hp_T",propNum:10}],maxLv:0,desc:function(){var e=this.lv,t=void 0===e?1:e,r=this.effects[0].propNum;return"战斗开始增加".concat(r*t,"%最大生命值")}},{id:10,name:"",skillType:l.BATTLE_TRIGGER,effects:[{triggerType:f.UNDER_ATTACK,effectType:p.REDUCTION_DAMAGE,targetType:h.SELF,valueType:d.FORMULA,reductionDamage:1,formula:"hp/300"}],maxLv:0,desc:function(){var e=this.lv,t=void 0===e?1:e,r=this.effects[0].reductionDamage;return"每有300点生命值减免".concat(t*r,"点伤害")}}],m=(r("a15b"),r("4d63"),r("25f0"),r("466d"),function(e){for(var t=[],r=[],i=0,a=0;i<e.length;i++){var n=e[i],s=void 0,o=void 0;switch(n){case"(":a=i+1,s=[],r.push(s),t.push(s);break;case"|":case"&":case"+":case"-":case"*":case"/":case"=":case"<":case">":o=e.substring(a,i),"="===e[i+1]?(a=i+2,n+="="):a=i+1,r.length>0?(o.length>0&&r[r.length-1].push(o),r[r.length-1].push(n)):(o.length>0&&t.push(o),t.push(n));break;case")":o=e.substring(a,i),r[r.length-1].push(o),a=i+1,r.pop();break}}return a<i&&t.push(e.substring(a,i)),t}),g=function e(t,r){if(3===r.length&&r.every((function(e){return"string"===typeof e})))return y(t,r.join(""));var i=!1;i=r[0]instanceof Array?e(t,r[0]):y(t,r[0]);for(var a=2;a<r.length;a+=2){var n=r[a],s=!1;s=n instanceof Array?e(t,n):y(t,n),i=y(t,"".concat(i).concat(r[a-1]).concat(s))}return i},y=function(e,t){var r=/(?:[?!=+*/-]|[><]=?)/,i=new RegExp("^(".concat(k.PropKeyList.join("|"),")$"));if(!r.test(t))return/^-?\d+(\.\d+)?$/.test(t)?+t:!!i.test(t)&&e[t];var a=t.split(r),n=t.match(r)[0],s=i.test(a[0])?e[a[0]]:+a[0],o=i.test(a[1])?e[a[1]]:+a[1];switch(n){case">":return s>o;case"<":return s<o;case">=":return s>=o;case"<=":return s<=o;case"=":return s===o;case"+":return s+o;case"-":return s-o;case"*":return s*o;case"/":return 0===o?0:s/o;case"&":return s&&o;case"|":return s||o}return!1},E=function(){function e(){Object(c["a"])(this,e),this.listeners={}}return Object(u["a"])(e,[{key:"emit",value:function(e,t){this.listeners[e]&&this.listeners[e].forEach((function(e){e(t)}))}},{key:"on",value:function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)}}]),e}(),T=E,b=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.name,i=void 0===r?"":r,a=t.hp,n=void 0===a?900:a,s=t.atk,o=void 0===s?9:s,u=t.cir,l=void 0===u?0:u,f=t.dodge,p=void 0===f?0:f,d=t.cirRate,h=void 0===d?200:d,v=t.atkSpeed,m=void 0===v?100:v;Object(c["a"])(this,e),this.name=i,this.hp=n,this.atk=o,this.cir=l,this.dodge=p,this.cirRate=h,this.atkSpeed=m,this.skills={},this.battleStartSkillIds=new Set,this.battleWinSkillIds=new Set,this.excludeSkillIds=[],this.currProps={},this.gameEvent=new T}return Object(u["a"])(e,[{key:"dealBattleStartEffectTrigger",value:function(e,t,r){var i=e.targetType,a=e.propKey,n=e.valueType,s=e.propNum,o=e.percentageProp,c=e.formula;switch(i){case h.SELF:r[a]+=this.getEffectValue({valueType:n,value:s*t,percentageProp:o,props:r,formula:c});break}}},{key:"dealBattleSkills",value:function(e,t){var r=this,i=e.lv,a=e.effects,n=e.id;a.forEach((function(e){var a=e.triggerType,s=e.condition,c=e.formula,u={};switch(a){case f.OBTAIN:r.dealBattleStartEffectTrigger(e,i,t);break;case f.TIME_ONCE:u=Object(o["a"])(Object(o["a"])({},e),{},{lv:i,skillId:n}),s&&(u.condition=m(s)),t.onceEffects.push(u);break;case f.TIME_INTERVAL:u=Object(o["a"])(Object(o["a"])({},e),{},{lv:i,timeProcess:0,skillId:n}),s&&(u.condition=m(s)),t.intervalEffects.push(u);break;case f.UNDER_ATTACK:u=Object(o["a"])(Object(o["a"])({},e),{},{lv:i,skillId:n}),s&&(u.condition=m(s)),c&&(u.formula=m(c)),t.underAttackEffects.push(u);break}}))}},{key:"createBattleProps",value:function(){var e=this,t={hp:this.hp,atk:this.atk,cir:this.cir,dodge:this.dodge,cirRate:this.cirRate,atkSpeed:this.atkSpeed,onceEffects:[],intervalEffects:[],underAttackEffects:[]};this.battleStartSkillIds.forEach((function(r){var i=e.skills[r];e.dealBattleSkills(i,t)})),this.currProps={hp:t.hp,maxHp:t.hp,atk:t.atk,cir:t.cir,dodge:t.dodge,cirRate:t.cirRate,atkSpeed:t.atkSpeed,onceEffects:t.onceEffects,intervalEffects:t.intervalEffects,underAttackEffects:t.underAttackEffects,atkProcess:0,recordList:[]}}},{key:"getAtkNum",value:function(e){var t=e/(1e4/this.currProps.atkSpeed);this.currProps.atkProcess+=t;var r=Math.floor(this.currProps.atkProcess);return this.currProps.atkProcess-=r,r}},{key:"triggerPropEffect",value:function(e,t){var r=t.targetType,i=t.propKey,a=t.valueType,n=t.lv,s=t.propNum,o=t.percentageProp,c=t.formula;switch(r){case h.SELF:this.currProps[i]+=this.getEffectValue({valueType:a,value:s*n,percentageProp:o,props:this.currProps,formula:c});break;case h.ENEMY:e.currProps[i]+=this.getEffectValue({valueType:a,value:s*n,percentageProp:o,props:e.currProps,formula:c});break}}},{key:"getCurrProp",value:function(e){var t=e.split("_");return"T"===t[1]?this[t[0]]:t[1]?void 0:this.currProps[e]}},{key:"getEffectValue",value:function(e){var t=e.valueType,r=e.value,i=e.percentageProp,a=e.props,n=e.formula;switch(t){case d.FIXED_VALUE:return r;case d.PERCENTAGE:return Math.floor(r/100*this.getCurrProp(i));case d.FORMULA:return r*Math.floor(g(a,n))}}},{key:"restoreHp",value:function(t){var r=t.restoreHp,i=void 0===r?0:r,a=t.lv,n=void 0===a?1:a,s=t.valueType,o=void 0===s?d.FIXED_VALUE:s,c=t.percentageProp,u=void 0===c?"maxHp":c,l=t.props,f=void 0===l?this.currProps:l,p=t.formula,h=this.getEffectValue({valueType:o,value:i*n,percentageProp:u,props:f,formula:p});this.addBattleRecord({recordType:e.RecordType.RESTORE_HP,restoreHp:h}),this.currProps.hp=Math.min(this.currProps.maxHp,this.currProps.hp+h)}},{key:"dealEffectTrigger",value:function(e,t){switch(e.effectType){case p.PROP:this.triggerPropEffect(t,e);break;case p.RESTORE_HP:this.restoreHp(e);break;case p.CONDITION_RESTORE_HP:g(this.currProps,e.condition)&&this.restoreHp(e.restoreHp*e.lv);break}}},{key:"triggerEffect",value:function(e,t,r){for(var i=this,a=0;a<this.currProps.onceEffects.length;){var n=this.currProps.onceEffects[a];n.triggerTime<=t?(this.dealEffectTrigger(n,e),this.currProps.onceEffects.splice(a,1)):a++}this.currProps.intervalEffects.forEach((function(t){t.timeProcess+=r,t.intervalTime<=t.timeProcess&&(i.dealEffectTrigger(t,e),t.timeProcess-=t.intervalTime)}))}},{key:"underAttackHandle",value:function(){var e=this,t=[],r=0;return this.currProps.underAttackEffects.forEach((function(i){var a=i.effectType,n=i.damage,s=i.lv,o=i.probability,c=i.reductionDamage,u=i.skillId,l=i.valueType,f=i.percentageProp,d=i.formula;switch(a){case p.DAMAGE:t.push({damage:n*s,skillId:u});break;case p.PROBABILITY_DAMAGE:100*Math.random()<o&&t.push({damage:n*s,skillId:u});break;case p.REDUCTION_DAMAGE:r+=e.getEffectValue({valueType:l,value:c*s,percentageProp:f,props:e.currProps,formula:d});break;case p.PROBABILITY_REDUCTION_DAMAGE:100*Math.random()<o&&(r+=c*s);break}})),{damages:t,reductionDamageTotal:r}}},{key:"addBattleRecord",value:function(t){t.numStr=t.recordType===e.RecordType.DAMAGE?"-".concat(t.damage):"+".concat(t.restoreHp),this.currProps.recordList.push(t),this.gameEvent.emit("record",t)}},{key:"on",value:function(e,t){this.gameEvent.on(e,t)}},{key:"attack",value:function(t){var r=this,i=t.underAttackHandle(this),a=i.damages,n=i.reductionDamageTotal,s=this.currProps.atk,o=this.currProps.cir-t.currProps.cir;if(o>100*Math.random()){var c=this.currProps.cirRate+Math.max(o-100,0);s*=c/100}s=Math.max(0,s-n);var u=t.currProps.dodge-this.currProps.dodge;if(Math.min(u,80)<100*Math.random()){var l=Math.max(u-80,0);s=Math.max(Math.floor(s*(100-l)/100),0)}t.addBattleRecord({recordType:e.RecordType.DAMAGE,damageType:e.DamageType.ATTACK,damage:s}),t.currProps.hp-=s,a.forEach((function(e){t.causeDamage(r,e)}))}},{key:"causeDamage",value:function(t,r){var i=r.damage,a=0;i=Math.max(Math.floor(i*(100-a)/100),0),t.addBattleRecord({recordType:e.RecordType.DAMAGE,damageType:e.DamageType.SKILL,damage:i,skillId:r.skillId}),t.currProps.hp-=i}},{key:"obtainSkill",value:function(e){var t=this;if(this.skills[e.id])this.skills[e.id].lv++;else{var r=JSON.parse(JSON.stringify(e));r.lv=1,r.desc=e.desc,this.skills[e.id]=r}0!==this.skills[e.id].maxLv&&this.skills[e.id].lv>=this.skills[e.id].maxLv&&this.excludeSkillIds.push(e.id),e.skillType===l.GET_TRIGGER?e.effects.forEach((function(e){switch(e.triggerType){case f.OBTAIN:t[e.propKey]+=e.propNum;break}})):e.skillType===l.BATTLE_TRIGGER&&this.battleStartSkillIds.add(e.id)}},{key:"getSkill",value:function(){var e=this,t=v.filter((function(t){return!e.excludeSkillIds.includes(t.id)}));if(!t.length)return null;this.obtainSkill(t[Math.floor(Math.random()*t.length)])}},{key:"getSkillOptions",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(r)return v;for(var i=v.filter((function(t){return!e.excludeSkillIds.includes(t.id)})),a=[],n=0;n<t;n++){var s=Math.floor(Math.random()*i.length);a.push(i[s]),i.splice(s,1)}return a}}]),e}();b.create=function(e){for(var t=new b,r=0;r<e;r++)t.getSkill();return t},b.RecordType={DAMAGE:1,RESTORE_HP:2},b.DamageType={ATTACK:1,SKILL:2},b.PropKeyList=["hp","maxHp","atk","cir","dodge","cirRate","atkSpeed"];var k=b,R=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"hp-bar"},[r("div",{staticClass:"hp-bar-curr",style:{width:e.rate+"%"}}),r("div",{staticClass:"hp-bar-text"},[r("span",{staticClass:"hp-bar-text-curr"},[e._v(e._s(e.curr))]),r("span",{staticClass:"hp-bar-text-split"},[e._v("/")]),r("span",{staticClass:"hp-bar-text-max"},[e._v(e._s(e.max))])])])},O=[],_=(r("a9e3"),{name:"HpBar",props:{curr:{type:Number,default:0},max:{type:Number,default:0}},computed:{rate:function(){return Math.min(this.max?this.curr/this.max*100:0,100)}}}),P=_,A=(r("cc5e"),r("2877")),I=Object(A["a"])(P,R,O,!1,null,"2dfd509e",null),x=I.exports,S=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"num-disappear"},[r("transition-group",{attrs:{name:"disappear"},on:{leave:e.leave}},e._l(e.numList,(function(t){return r("dl",{key:t.id,staticClass:"num",style:{transform:"translateX(calc("+t.startOffset+"px - 50%))",color:t.color},attrs:{"data-startOffset":t.startOffset,"data-endOffset":t.endOffset}},[e._v(" "+e._s(t.num)+" ")])})),0)],1)},N=[],L={name:"NumDisappear",data:function(){return{numList:[],id:1}},methods:{addNum:function(e){var t=this,r=e.num,i=e.color,a={num:r,color:i,id:this.id++,startOffset:25-Math.floor(50*Math.random()),endOffset:50-Math.floor(100*Math.random())};a.sto=setTimeout((function(){var e=t.numList.indexOf(a);e>-1&&t.numList.splice(e,1)})),this.numList.push(a)},leave:function(e,t){e.style.bottom="calc(100% - 1em)",e.style.opacity="0",e.style.transform="translateX(calc(".concat(e.dataset.startOffset+e.dataset.endOffset,"px - 50%))"),setTimeout((function(){t()}),3e3)}}},D=L,w=(r("1cc4"),Object(A["a"])(D,S,N,!1,null,"3748eff8",null)),M=w.exports,G=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"skill-options"},e._l(e.skills,(function(t){return r("dl",{key:"skillOption-"+t.id,staticClass:"skill-option",on:{click:function(r){return e.selectSkill(t)}}},[e._v(" "+e._s(t.desc())+" ")])})),0)},B=[],C={name:"SkillOptions",props:{value:{type:Boolean,default:!1},skills:{type:Array,default:function(){return[]}}},computed:{visible:{get:function(){return this.value},set:function(e){this.$emit("input",e)}}},methods:{selectSkill:function(e){this.$emit("select",e),this.visible=!1}}},F=C,j=(r("1dd1"),Object(A["a"])(F,G,B,!1,null,"1526bdd2",null)),H=j.exports,U={components:{HpBar:x,SkillOptions:H,NumDisappear:M},name:"GameMain",data:function(){return{cave:1,time:0,player:new k,enemy:null,skillOptions:[],skillOptionVisible:!1,status:"selectOption",loopTime:50,sto:null,testFlag:!1}},methods:{caveReset:function(){this.showSkillOptions(),this.cave++,this.time=0},createEnemy:function(){var e=this;this.enemy=k.create(1),this.enemy.on("record",(function(t){e.$refs.enemyNumDisappear.addNum({num:t.numStr,color:t.recordType===k.RecordType.DAMAGE?"blue":"green"})}))},createBattlefield:function(){var e=this;this.player.createBattleProps(this.enemy),this.enemy.createBattleProps(this.player),this.status="battle";var t=this.effectLoop();t||(this.sto=setTimeout((function(){e.loop()}),this.loopTime))},showSkillOptions:function(){this.status="selectOption",this.skillOptions=this.player.getSkillOptions(3,this.testFlag),this.skillOptionVisible=!0},selectSkill:function(e){this.skillOptions=[],this.player.obtainSkill(e),this.status="waitBattle"},effectLoop:function(){return this.player.triggerEffect(this.enemy,this.time,this.loopTime),this.enemy.currProps.hp<=0?(this.caveReset(),"win"):(this.enemy.triggerEffect(this.player,this.time,this.loopTime),this.player.currProps.hp<=0?"lose":void 0)},loop:function(){var e,t=this,r=new Date;this.time+=this.loopTime;var i=this.effectLoop();if(!i){var a=this.player.getAtkNum(this.loopTime);for(e=0;e<a;e++)this.player.attack(this.enemy);if(this.enemy.currProps.hp<=0)this.caveReset();else{var n=this.enemy.getAtkNum(this.loopTime);for(e=0;e<n;e++)this.enemy.attack(this.player);this.player.currProps.hp<=0||(this.sto=setTimeout((function(){t.loop()}),Math.max(this.loopTime-(new Date-r),0)))}}},backMenu:function(){this.$emit("backMenu")}},created:function(){this.createEnemy(),this.showSkillOptions()},mounted:function(){var e=this;this.player.on("record",(function(t){e.$refs.playerNumDisappear.addNum({num:t.numStr,color:t.recordType===k.RecordType.DAMAGE?"blue":"green"})}))}},V=U,K=(r("5542"),Object(A["a"])(V,n,s,!1,null,"9d94595e",null)),X=K.exports,$=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("button",{on:{click:e.start}},[e._v("开始")])])},z=[],Y={name:"GameMenu",methods:{start:function(){this.$emit("start")}}},J=Y,W=Object(A["a"])(J,$,z,!1,null,"3e86a9fe",null),Q=W.exports,q={components:{GameMain:X,GameMenu:Q},name:"Roguelike",data:function(){return{scene:"menu"}},methods:{start:function(){this.scene="game"},backMenu:function(){this.scene="menu"},add:function(){var e="(hp/maxHp)<0.5";console.log(m(e)),console.log(g({hp:20,maxHp:50},m(e)))}}},Z=q,ee=Object(A["a"])(Z,i,a,!1,null,"3ec33287",null);t["default"]=ee.exports},"44e7":function(e,t,r){var i=r("861d"),a=r("c6b6"),n=r("b622"),s=n("match");e.exports=function(e){var t;return i(e)&&(void 0!==(t=e[s])?!!t:"RegExp"==a(e))}},"466d":function(e,t,r){"use strict";var i=r("d784"),a=r("825a"),n=r("50c4"),s=r("1d80"),o=r("8aa5"),c=r("14c3");i("match",1,(function(e,t,r){return[function(t){var r=s(this),i=void 0==t?void 0:t[e];return void 0!==i?i.call(t,r):new RegExp(t)[e](String(r))},function(e){var i=r(t,e,this);if(i.done)return i.value;var s=a(e),u=String(this);if(!s.global)return c(s,u);var l=s.unicode;s.lastIndex=0;var f,p=[],d=0;while(null!==(f=c(s,u))){var h=String(f[0]);p[d]=h,""===h&&(s.lastIndex=o(u,n(s.lastIndex),l)),d++}return 0===d?null:p}]}))},"4d63":function(e,t,r){var i=r("83ab"),a=r("da84"),n=r("94ca"),s=r("7156"),o=r("9bf2").f,c=r("241c").f,u=r("44e7"),l=r("ad6d"),f=r("9f7f"),p=r("6eeb"),d=r("d039"),h=r("69f3").set,v=r("2626"),m=r("b622"),g=m("match"),y=a.RegExp,E=y.prototype,T=/a/g,b=/a/g,k=new y(T)!==T,R=f.UNSUPPORTED_Y,O=i&&n("RegExp",!k||R||d((function(){return b[g]=!1,y(T)!=T||y(b)==b||"/a/i"!=y(T,"i")})));if(O){var _=function(e,t){var r,i=this instanceof _,a=u(e),n=void 0===t;if(!i&&a&&e.constructor===_&&n)return e;k?a&&!n&&(e=e.source):e instanceof _&&(n&&(t=l.call(e)),e=e.source),R&&(r=!!t&&t.indexOf("y")>-1,r&&(t=t.replace(/y/g,"")));var o=s(k?new y(e,t):y(e,t),i?this:E,_);return R&&r&&h(o,{sticky:r}),o},P=function(e){e in _||o(_,e,{configurable:!0,get:function(){return y[e]},set:function(t){y[e]=t}})},A=c(y),I=0;while(A.length>I)P(A[I++]);E.constructor=_,_.prototype=E,p(a,"RegExp",_)}v("RegExp")},"4de4":function(e,t,r){"use strict";var i=r("23e7"),a=r("b727").filter,n=r("1dde"),s=n("filter");i({target:"Array",proto:!0,forced:!s},{filter:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}})},5530:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));r("b64b"),r("a4d3"),r("4de4"),r("e439"),r("159b"),r("dbb4");var i=r("ade3");function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function n(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){Object(i["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}},5542:function(e,t,r){"use strict";r("1bed")},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,r){var i=r("1d80"),a=r("5899"),n="["+a+"]",s=RegExp("^"+n+n+"*"),o=RegExp(n+n+"*$"),c=function(e){return function(t){var r=String(i(t));return 1&e&&(r=r.replace(s,"")),2&e&&(r=r.replace(o,"")),r}};e.exports={start:c(1),end:c(2),trim:c(3)}},"5a34":function(e,t,r){var i=r("44e7");e.exports=function(e){if(i(e))throw TypeError("The method doesn't accept regular expressions");return e}},6062:function(e,t,r){"use strict";var i=r("6d61"),a=r("6566");e.exports=i("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),a)},6566:function(e,t,r){"use strict";var i=r("9bf2").f,a=r("7c73"),n=r("e2cc"),s=r("0366"),o=r("19aa"),c=r("2266"),u=r("7dd0"),l=r("2626"),f=r("83ab"),p=r("f183").fastKey,d=r("69f3"),h=d.set,v=d.getterFor;e.exports={getConstructor:function(e,t,r,u){var l=e((function(e,i){o(e,l,t),h(e,{type:t,index:a(null),first:void 0,last:void 0,size:0}),f||(e.size=0),void 0!=i&&c(i,e[u],{that:e,AS_ENTRIES:r})})),d=v(t),m=function(e,t,r){var i,a,n=d(e),s=g(e,t);return s?s.value=r:(n.last=s={index:a=p(t,!0),key:t,value:r,previous:i=n.last,next:void 0,removed:!1},n.first||(n.first=s),i&&(i.next=s),f?n.size++:e.size++,"F"!==a&&(n.index[a]=s)),e},g=function(e,t){var r,i=d(e),a=p(t);if("F"!==a)return i.index[a];for(r=i.first;r;r=r.next)if(r.key==t)return r};return n(l.prototype,{clear:function(){var e=this,t=d(e),r=t.index,i=t.first;while(i)i.removed=!0,i.previous&&(i.previous=i.previous.next=void 0),delete r[i.index],i=i.next;t.first=t.last=void 0,f?t.size=0:e.size=0},delete:function(e){var t=this,r=d(t),i=g(t,e);if(i){var a=i.next,n=i.previous;delete r.index[i.index],i.removed=!0,n&&(n.next=a),a&&(a.previous=n),r.first==i&&(r.first=a),r.last==i&&(r.last=n),f?r.size--:t.size--}return!!i},forEach:function(e){var t,r=d(this),i=s(e,arguments.length>1?arguments[1]:void 0,3);while(t=t?t.next:r.first){i(t.value,t.key,this);while(t&&t.removed)t=t.previous}},has:function(e){return!!g(this,e)}}),n(l.prototype,r?{get:function(e){var t=g(this,e);return t&&t.value},set:function(e,t){return m(this,0===e?0:e,t)}}:{add:function(e){return m(this,e=0===e?0:e,e)}}),f&&i(l.prototype,"size",{get:function(){return d(this).size}}),l},setStrong:function(e,t,r){var i=t+" Iterator",a=v(t),n=v(i);u(e,t,(function(e,t){h(this,{type:i,target:e,state:a(e),kind:t,last:void 0})}),(function(){var e=n(this),t=e.kind,r=e.last;while(r&&r.removed)r=r.previous;return e.target&&(e.last=r=r?r.next:e.state.first)?"keys"==t?{value:r.key,done:!1}:"values"==t?{value:r.value,done:!1}:{value:[r.key,r.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),r?"entries":"values",!r,!0),l(t)}}},"6d61":function(e,t,r){"use strict";var i=r("23e7"),a=r("da84"),n=r("94ca"),s=r("6eeb"),o=r("f183"),c=r("2266"),u=r("19aa"),l=r("861d"),f=r("d039"),p=r("1c7e"),d=r("d44e"),h=r("7156");e.exports=function(e,t,r){var v=-1!==e.indexOf("Map"),m=-1!==e.indexOf("Weak"),g=v?"set":"add",y=a[e],E=y&&y.prototype,T=y,b={},k=function(e){var t=E[e];s(E,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(m&&!l(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return m&&!l(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(m&&!l(e))&&t.call(this,0===e?0:e)}:function(e,r){return t.call(this,0===e?0:e,r),this})},R=n(e,"function"!=typeof y||!(m||E.forEach&&!f((function(){(new y).entries().next()}))));if(R)T=r.getConstructor(t,e,v,g),o.REQUIRED=!0;else if(n(e,!0)){var O=new T,_=O[g](m?{}:-0,1)!=O,P=f((function(){O.has(1)})),A=p((function(e){new y(e)})),I=!m&&f((function(){var e=new y,t=5;while(t--)e[g](t,t);return!e.has(-0)}));A||(T=t((function(t,r){u(t,T,e);var i=h(new y,t,T);return void 0!=r&&c(r,i[g],{that:i,AS_ENTRIES:v}),i})),T.prototype=E,E.constructor=T),(P||I)&&(k("delete"),k("has"),v&&k("get")),(I||_)&&k(g),m&&E.clear&&delete E.clear}return b[e]=T,i({global:!0,forced:T!=y},b),d(T,e),m||r.setStrong(T,e,v),T}},7156:function(e,t,r){var i=r("861d"),a=r("d2bb");e.exports=function(e,t,r){var n,s;return a&&"function"==typeof(n=t.constructor)&&n!==r&&i(s=n.prototype)&&s!==r.prototype&&a(e,s),e}},"99af":function(e,t,r){"use strict";var i=r("23e7"),a=r("d039"),n=r("e8b5"),s=r("861d"),o=r("7b0b"),c=r("50c4"),u=r("8418"),l=r("65f0"),f=r("1dde"),p=r("b622"),d=r("2d00"),h=p("isConcatSpreadable"),v=9007199254740991,m="Maximum allowed index exceeded",g=d>=51||!a((function(){var e=[];return e[h]=!1,e.concat()[0]!==e})),y=f("concat"),E=function(e){if(!s(e))return!1;var t=e[h];return void 0!==t?!!t:n(e)},T=!g||!y;i({target:"Array",proto:!0,forced:T},{concat:function(e){var t,r,i,a,n,s=o(this),f=l(s,0),p=0;for(t=-1,i=arguments.length;t<i;t++)if(n=-1===t?s:arguments[t],E(n)){if(a=c(n.length),p+a>v)throw TypeError(m);for(r=0;r<a;r++,p++)r in n&&u(f,p,n[r])}else{if(p>=v)throw TypeError(m);u(f,p++,n)}return f.length=p,f}})},"9e6d":function(e,t,r){},a15b:function(e,t,r){"use strict";var i=r("23e7"),a=r("44ad"),n=r("fc6a"),s=r("a640"),o=[].join,c=a!=Object,u=s("join",",");i({target:"Array",proto:!0,forced:c||!u},{join:function(e){return o.call(n(this),void 0===e?",":e)}})},a640:function(e,t,r){"use strict";var i=r("d039");e.exports=function(e,t){var r=[][e];return!!r&&i((function(){r.call(null,t||function(){throw 1},1)}))}},a9e3:function(e,t,r){"use strict";var i=r("83ab"),a=r("da84"),n=r("94ca"),s=r("6eeb"),o=r("5135"),c=r("c6b6"),u=r("7156"),l=r("c04e"),f=r("d039"),p=r("7c73"),d=r("241c").f,h=r("06cf").f,v=r("9bf2").f,m=r("58a8").trim,g="Number",y=a[g],E=y.prototype,T=c(p(E))==g,b=function(e){var t,r,i,a,n,s,o,c,u=l(e,!1);if("string"==typeof u&&u.length>2)if(u=m(u),t=u.charCodeAt(0),43===t||45===t){if(r=u.charCodeAt(2),88===r||120===r)return NaN}else if(48===t){switch(u.charCodeAt(1)){case 66:case 98:i=2,a=49;break;case 79:case 111:i=8,a=55;break;default:return+u}for(n=u.slice(2),s=n.length,o=0;o<s;o++)if(c=n.charCodeAt(o),c<48||c>a)return NaN;return parseInt(n,i)}return+u};if(n(g,!y(" 0o1")||!y("0b1")||y("+0x1"))){for(var k,R=function(e){var t=arguments.length<1?0:e,r=this;return r instanceof R&&(T?f((function(){E.valueOf.call(r)})):c(r)!=g)?u(new y(b(t)),r,R):b(t)},O=i?d(y):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),_=0;O.length>_;_++)o(y,k=O[_])&&!o(R,k)&&v(R,k,h(y,k));R.prototype=E,E.constructor=R,s(a,g,R)}},ab13:function(e,t,r){var i=r("b622"),a=i("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[a]=!1,"/./"[e](t)}catch(i){}}return!1}},ade3:function(e,t,r){"use strict";function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.d(t,"a",(function(){return i}))},b64b:function(e,t,r){var i=r("23e7"),a=r("7b0b"),n=r("df75"),s=r("d039"),o=s((function(){n(1)}));i({target:"Object",stat:!0,forced:o},{keys:function(e){return n(a(e))}})},bb2f:function(e,t,r){var i=r("d039");e.exports=!i((function(){return Object.isExtensible(Object.preventExtensions({}))}))},caad:function(e,t,r){"use strict";var i=r("23e7"),a=r("4d64").includes,n=r("44d2");i({target:"Array",proto:!0},{includes:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),n("includes")},cc5e:function(e,t,r){"use strict";r("9e6d")},dbb4:function(e,t,r){var i=r("23e7"),a=r("83ab"),n=r("56ef"),s=r("fc6a"),o=r("06cf"),c=r("8418");i({target:"Object",stat:!0,sham:!a},{getOwnPropertyDescriptors:function(e){var t,r,i=s(e),a=o.f,u=n(i),l={},f=0;while(u.length>f)r=a(i,t=u[f++]),void 0!==r&&c(l,t,r);return l}})},e439:function(e,t,r){var i=r("23e7"),a=r("d039"),n=r("fc6a"),s=r("06cf").f,o=r("83ab"),c=a((function(){s(1)})),u=!o||c;i({target:"Object",stat:!0,forced:u,sham:!o},{getOwnPropertyDescriptor:function(e,t){return s(n(e),t)}})},e997:function(e,t,r){},f183:function(e,t,r){var i=r("d012"),a=r("861d"),n=r("5135"),s=r("9bf2").f,o=r("90e3"),c=r("bb2f"),u=o("meta"),l=0,f=Object.isExtensible||function(){return!0},p=function(e){s(e,u,{value:{objectID:"O"+ ++l,weakData:{}}})},d=function(e,t){if(!a(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!n(e,u)){if(!f(e))return"F";if(!t)return"E";p(e)}return e[u].objectID},h=function(e,t){if(!n(e,u)){if(!f(e))return!0;if(!t)return!1;p(e)}return e[u].weakData},v=function(e){return c&&m.REQUIRED&&f(e)&&!n(e,u)&&p(e),e},m=e.exports={REQUIRED:!1,fastKey:d,getWeakData:h,onFreeze:v};i[u]=!0}}]);
//# sourceMappingURL=chunk-efa6cf8c.d6623429.js.map